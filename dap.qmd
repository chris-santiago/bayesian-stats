---
title: "Data Analysis Project"
format: html
editor: visual
editor_options: 
  chunk_output_type: inline
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both

```{r}
library(tidyverse)
library(rjags)

source("funcs.R")
```

```{r}
data = datasets::chickwts %>%
  mutate(
    feed_name = feed,
    feed = as.numeric(feed)
    )
```

You can add options to executable code like this

```{r}

head(data)
```

```{r}

table(data$feed_name)
```

```{r}

ggplot(data, aes(x=weight)) +
  geom_histogram(bins = 10)
```

```{r}

ggplot(data, aes(x=feed_name, y=weight, group=feed_name)) +
  geom_boxplot()
```

```{r}
mod.base = lm(weight ~ feed_name + 0, data=data)
summary(mod.base)
```

```{r}

mod_string = " model {
  for (i in 1:length(weight)) {
    weight[i] ~ dnorm(mu, sigma)
  }
  
  mu ~ dgamma(10, 1/10)
  sigma ~ dlnorm(1, 1)
} "

set.seed(43)
data_jags = as.list(data)
params = c("mu", "sigma")

mod.pooled = run_sim(
  model.str = mod_string,
  data = data_jags,
  params = params
)
```

```{r}
(dic.pooled = dic.samples(mod.pooled$obj, n.iter=1e3))
```

```{r}
round(mod.pooled$coefs, 4)
```

```{r}
plot(mod.pooled$csim)
```

```{r}
mod_string = " model {
  for (i in 1:length(weight)) {
    weight[i] ~ dnorm(theta[feed[i]], sigma)
  }
  
  for (j in 1:max(feed)) {
    theta[j] ~ dnorm(mu, tau)
  }
  
  mu ~ dgamma(10, 1)
  tau ~ dlnorm(1, 1)
  sigma ~ dlnorm(1, 1)
  
} "

set.seed(43)
data_jags = as.list(data)
params = c("theta", "mu", "sigma")

mod.hier = run_sim(
  model.str = mod_string,
  data = data_jags,
  params = params
)
```

```{r}
(dic.hier = dic.samples(mod.hier$obj, n.iter=1e3))
```

```{r}

round(mod.hier$coefs, 4)
```

```{r}
plot(mod.hier$csim, ask=FALSE)
```

```{r}

round(mod.1$coefs, 4)
```

The `echo: false` option disables the printing of code (only output is displayed).
